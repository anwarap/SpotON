
<%- include('../partials/head.ejs') %>


<%- include('../partials/userHeader.ejs') %>


<!-- mini cart start -->
        <div class="sidebar-cart-active">
            <div class="sidebar-cart-all">
                <a class="cart-close" href="#"><i class="icon_close"></i></a>
                <div class="cart-content">
                    <h3>Shopping Cart</h3>
                    <ul>
                        <li class="single-product-cart">
                            <div class="cart-img">
                                <a href="#"><img src="assets/images/cart/cart-1.jpg" alt=""></a>
                            </div>
                            <div class="cart-title">
                                <h4><a href="#">Simple Black T-Shirt</a></h4>
                                <span> 1 × $49.00	</span>
                            </div>
                            <div class="cart-delete">
                                <a href="#">×</a>
                            </div>
                        </li>
                        <li class="single-product-cart">
                            <div class="cart-img">
                                <a href="#"><img src="assets/images/cart/cart-2.jpg" alt=""></a>
                            </div>
                            <div class="cart-title">
                                <h4><a href="#">Norda Backpack</a></h4>
                                <span> 1 × $49.00	</span>
                            </div>
                            <div class="cart-delete">
                                <a href="#">×</a>
                            </div>
                        </li>
                    </ul>
                    <div class="cart-total">
                        <h4>Subtotal: <span>$170.00</span></h4>
                    </div>
                    <div class="cart-checkout-btn">
                        <a class="btn-hover cart-btn-style" href="cart.html">view cart</a>
                        <a class="no-mrg btn-hover cart-btn-style" href="checkout.html">checkout</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- <div class="breadcrumb-area bg-gray" style="    margin-top: 190px">
            <div class="container">
                <div class="breadcrumb-content text-center" >
                    <ul>
                        <li>
                            <a href="/">Home</a>
                        </li>
                        <li class="active">my account </li>
                    </ul>
                </div>
            </div>
        </div> -->
        <!-- my account wrapper start -->
        <div class="my-account-wrapper pt-120 pb-120">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <!-- My Account Page Start -->
                        <div class="myaccount-page-wrapper">
                            <!-- My Account Tab Menu Start -->
                            <div class="row">
                                <div class="col-lg-3 col-md-4">
                                    <div class="myaccount-tab-menu nav" role="tablist">
                                        <a href="#dashboad" class="active" data-toggle="tab"><i class="fa fa-dashboard"></i>
                                            Dashboard</a>
                                        <a href="#orders" data-toggle="tab"><i class="fa fa-cart-arrow-down"></i> Orders</a>
                                        <!-- <a href="#payment-method" data-toggle="tab"><i class="fa fa-credit-card"></i> Payment
                                            Method</a> -->
                                            <a href="#address-edit" data-toggle="tab"><i class="fa fa-map-marker"></i> address</a>
                                            <a href="#account-info" data-toggle="tab"><i class="fa fa-user"></i> Edit Profile</a>
                                            <a href="/profile/changePassword" > Change Password</a>
                                        <!-- <a href="login-register.html"><i class="fa fa-sign-out"></i> Logout</a> -->
                                    </div>
                                </div>
                                <!-- My Account Tab Menu End -->
                                <!-- My Account Tab Content Start -->
                                <div class="col-lg-9 col-md-8">
                                    <div class="tab-content" id="myaccountContent">
                                        <!-- Single Tab Content Start -->
                                        <div class="tab-pane fade show active" id="dashboad" role="tabpanel">
                                            <div class="myaccount-content">
                                                <h3>Dashboard</h3>
                                                <div class="welcome">
                                                    <% if (user) { %>
                                                        <ul class="list-group">
                                                          <li class="list-group-item">
                                                            <span class="fw-bold">Name:</span>
                                                            <%= user.fname %>
                                                              <%= user.lname %>
                                                        
                                                          </li>
                                                          <li class="list-group-item">
                                                            <span class="fw-bold">Mobile:</span>
                                                            <%= user.mobile %>
                                                          </li>
                                                          <li class="list-group-item">
                                                            <span class="fw-bold">Email:</span>
                                                            <%= user.email %>
                                                          </li>
                                                          <% if(userAddress){ %>
                                              
                                              
                                              
                                              
                                                            <li class="list-group-item">
                                                              <span class=""><b>Address:</b><br>
                                                                <%= userAddress.addresses[0].userName %>
                                                              </span><br>
                                                              <span class="">
                                                                <%= userAddress.addresses[0].email %>
                                                              </span><br>
                                                              <span class="">
                                                                <%= userAddress.addresses[0].address %>
                                                              </span><br>
                                                              <span class="">
                                                                <%= userAddress.addresses[0].town %>
                                                              </span><br>
                                                              <span class="">
                                                                <%= userAddress.addresses[0].state %>
                                                              </span><br>
                                                              <span class="">
                                                                <%= userAddress.addresses[0].country %>
                                                              </span><br>
                                                              <span class="">
                                                                <%= userAddress.addresses[0].zip %>
                                                              </span><br>
                                                              <span class="">
                                                                <%= userAddress.addresses[0].mobile %>
                                                              </span><br>
                                              
                                              
                                                            </li>
                                              
                                              
                                                            <% }else{ %>
                                                              <li class="list-group-item">
                                                                <span class=""><b>Address:</b> No saved address <a
                                                                    class="fw-bold text-primary text-decoration-underline"
                                                                    href="/profile/id=<%= user._id %>/addaddress">Add Address</a> </span>
                                              
                                                              </li>
                                                              <% } %>
                                                                <li class="list-group-item text-center">
                                                                  <!-- <span class="fw-bold text-success"><a href="/myorders"> -->
                                                                      <!-- <button class="btn btn-dark text-white rounded-0 fw-bold fs-7 mt-2 mb-2"><i
                                                                          class="bi bi-border-style"></i>
                                                                        MY ORDERS</button>
                                                                    </a></span> -->
                                                                  <span class="fw-bold text-success"><a href="/profile/id=<%= user._id %>/addaddress">
                                                                      <button class="btn btn-dark text-white rounded-0 fw-bold fs-7 mt-2 mb-2"><i
                                                                          class="bi bi-plus-lg"></i>
                                                                        ADD ADDRESS</button>
                                                                    </a></span>
                                                                  <span class="fw-bold text-success"><a href="/profile/<%= user._id %>/manageaddress">
                                                                      <button class="btn btn-dark text-white rounded-0 fw-bold fs-7 mt-2 mb-2"><i
                                                                          class="bi bi-house"></i>
                                                                        MANAGE ADDRESS</button>
                                                                    </a></span>
                                                                  <span class="fw-bold text-success"><a href="/profile/id=<%= user._id %>/managepassword">
                                                                      <button class="btn btn-dark text-white rounded-0 fw-bold fs-7 mt-2 mb-2"><i
                                                                          class="bi bi-key"></i>
                                                                        MANAGE PASSWORD</button>
                                                                    </a></span>
                                                                </li>
                                                                <!-- <li class="list-group-item text-center">
                                                                  <span class="fw-bold  text-success">Logged in:</span> <span id="datetime" class="ps-2 pe-2"></span>
                                                                </li> -->
                                                                <!-- You can add more profile details as needed -->
                                                        </ul>
                                                        <% } else { %>
                                                          <!-- User not found -->
                                                          <p>User not found</p>
                                                          <% } %>
                                                    <!-- <p>Hello, <strong>Alex Tuntuni</strong> (If Not <strong>Tuntuni !</strong><a href="login-register.html" class="logout"> Logout</a>)</p> -->
                                                </div>

                                                <!-- <p class="mb-0">From your account dashboard. you can easily check & view your recent orders, manage your shipping and billing addresses and edit your password and account details.</p> -->
                                            </div>
                                        </div>
                                        <!-- Single Tab Content End -->
                                        <!-- Single Tab Content Start -->
                                        <div class="tab-pane fade" id="orders" role="tabpanel">
                                            <div class="myaccount-content">
                                                <h3>Orders</h3>
                                                <div class="myaccount-table table-responsive text-center">
                                                    <table class="table table-bordered">
                                                        <thead class="thead-light">
                                                            <tr>
                                                                <th>Order</th>
                                                                <th>Date</th>
                                                                <th>Status</th>
                                                                <th>Total</th>
                                                                <th>Action</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>1</td>
                                                                <td>Aug 22, 2018</td>
                                                                <td>Pending</td>
                                                                <td>$3000</td>
                                                                <td><a href="cart.html" class="check-btn sqr-btn ">View</a></td>
                                                            </tr>
                                                            <tr>
                                                                <td>2</td>
                                                                <td>July 22, 2018</td>
                                                                <td>Approved</td>
                                                                <td>$200</td>
                                                                <td><a href="cart.html" class="check-btn sqr-btn ">View</a></td>
                                                            </tr>
                                                            <tr>
                                                                <td>3</td>
                                                                <td>June 12, 2017</td>
                                                                <td>On Hold</td>
                                                                <td>$990</td>
                                                                <td><a href="cart.html" class="check-btn sqr-btn ">View</a></td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Single Tab Content End -->
                                        <!-- Single Tab Content Start -->
                                        <!-- <div class="tab-pane fade" id="download" role="tabpanel">
                                            <form action="/profile/editPassword" method='post' id="submit-form">
                                            
                                                <legend>Password change</legend>
                                                <div class="single-input-item">
                                                    <label for="current-pwd" class="required">Current Password</label>
                                                    <input type="password" id="oldpassword-input" />
                                                </div>
                                                <div class="row">
                                                    <div class="col-lg-6">
                                                        <div class="single-input-item">
                                                            <label for="new-pwd" class="required">New Password</label>
                                                            <input type="password" id="newpassword-input" />
                                                        </div>
                                                    </div>
                                                    <div class="col-lg-6">
                                                        <div class="single-input-item">
                                                            <label for="confirm-pwd" class="required">Confirm Password</label>
                                                            <input type="password" id="confirmpassword-input" />
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="text-danger text-center" id="message-error"></div> 
                                                <div class="single-input-item">
                                                    <button class="check-btn sqr-btn " style="    margin-top: 10px;
                                                    border: none;
                                                    background-color: #ff2f2f;
                                                    text-transform: uppercase;
                                                    font-weight: 600;
                                                    padding: 9px 25px;
                                                    color: #fff;
                                                    font-size: 13px;">Save Changes</button>
                                                </div>
                                            </form>
                                        </div> -->
                                        <!-- Single Tab Content End -->
                                        <!-- Single Tab Content Start -->
                                        <div class="tab-pane fade" id="payment-method" role="tabpanel">
                                            <div class="myaccount-content">
                                                <h3>Payment Method</h3>
                                                <p class="saved-message">You Can't Saved Your Payment Method yet.</p>
                                            </div>
                                        </div>
                                        <!-- Single Tab Content End -->
                                        <!-- Single Tab Content Start -->
                                        <div class="tab-pane fade" id="address-edit" role="tabpanel">
                                            <div class="myaccount-content">
                                                <h3>Billing Address</h3>
                                                <address>
                                                    <p><strong>Alex Tuntuni</strong></p>
                                                    <p>1355 Market St, Suite 900 <br>
                                                San Francisco, CA 94103</p>
                                                    <p>Mobile: (123) 456-7890</p>
                                                </address>
                                                <a href="#" class="check-btn sqr-btn "><i class="fa fa-edit"></i> Edit Address</a>
                                            </div>
                                        </div>
                                        <!-- Single Tab Content End -->
                                        <!-- Single Tab Content Start -->
                                        <div class="tab-pane fade" id="account-info" role="tabpanel">
                                            <div class="myaccount-content">
                                                <h3>Edit Profile</h3>
                                                <div class="account-details-form">
                                                    <form action="/profile/editProfile" method='post' id="submit-form">
                                                        <div class="row">
                                                            <div class="col-lg-6">
                                                                <div class="single-input-item">
                                                                    <label for="first-name" class="required">First Name</label>
                                                                    <input type="text" class="rounded-0 form-control" name="fname" value="<%=user.fname %>" id="fname-input"  >
                                                                </div>
                                                            </div>
                                                            <div class="col-lg-6">
                                                                <div class="single-input-item">
                                                                    <label for="last-name" class="required">Last Name</label>
                                                                    <input type="text" class="rounded-0 form-control" name="lname" value="<%=user.lname %>" id="lname-input" >
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="single-input-item">
                                                            <label for="email" class="required">Email Address</label>
                                                            <input type="email" class="rounded-0 form-control" name="email" value="<%=user.email %>" id="email-input" />
                                                        </div>
                                                        <div class="single-input-item">
                                                            <label for="display-name" class="required">Mobile No</label>
                                                            <input type="text" class="rounded-0 form-control" name="mobile" value="<%=user.mobile %>" id="mobno-input" />
                                                        </div>
                                                        <div class="text-danger text-center" id="message-error"></div>
                                                        <div class="single-input-item">
                                                            <button class="check-btn sqr-btn ">Save Changes</button>
                                                        </div>
                                                    </form>
                                                       
                                                </div>
                                            </div>
                                        </div> <!-- Single Tab Content End -->
                                    </div>
                                </div> <!-- My Account Tab Content End -->
                            </div>
                        </div> <!-- My Account Page End -->
                    </div>
                </div>
            </div>
        </div>
        <!-- my account wrapper end -->
        <div class="subscribe-area bg-gray pt-115 pb-115">
            <div class="container">
                <div class="row">
                    <div class="col-lg-5 col-md-5">
                        <div class="section-title">
                            <h2>keep connected</h2>
                            <p>Get updates by subscribe our weekly newsletter</p>
                        </div>
                    </div>
                    <div class="col-lg-7 col-md-7">
                        <div id="mc_embed_signup" class="subscribe-form">
                            <form id="mc-embedded-subscribe-form" class="validate subscribe-form-style" novalidate="" target="_blank" name="mc-embedded-subscribe-form" method="post" action="https://devitems.us11.list-manage.com/subscribe/post?u=6bbb9b6f5827bd842d9640c82&amp;id=05d85f18ef">
                                <div id="mc_embed_signup_scroll" class="mc-form">
                                    <input class="email" type="email" required="" placeholder="Enter your email address" name="EMAIL" value="">
                                    <div class="mc-news" aria-hidden="true">
                                        <input type="text" value="" tabindex="-1" name="b_6bbb9b6f5827bd842d9640c82_05d85f18ef">
                                    </div>
                                    <div class="clear">
                                        <input id="mc-embedded-subscribe" class="button" type="submit" name="subscribe" value="Subscribe">
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <footer class="footer-area bg-gray pb-30">
            <div class="container">
                <div class="row">
                    <div class="col-lg-6 col-md-6">
                        <div class="contact-info-wrap">
                            <div class="footer-logo">
                                <a href="#"><img src="assets/images/logo/logo.png" alt="logo"></a>
                            </div>
                            <div class="single-contact-info">
                                <span>Our Location</span>
                                <p>869 General Village Apt. 645, Moorebury, USA</p>
                            </div>
                            <div class="single-contact-info">
                                <span>24/7 hotline:</span>
                                <p>(+99) 052 128 2399</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6 col-md-6">
                        <div class="footer-right-wrap">
                            <div class="footer-menu">
                                <nav>
                                    <ul>
                                        <li><a href="index.html">home</a></li>
                                        <li><a href="shop.html">Shop</a></li>
                                        <li><a href="shop.html">Product </a></li>
                                        <li><a href="contact.html">Contact</a></li>
                                        <li><a href="blog.html">Blog.</a></li>
                                    </ul>
                                </nav>
                            </div>
                            <div class="social-style-2 social-style-2-mrg">
                                <a href="#"><i class="social_twitter"></i></a>
                                <a href="#"><i class="social_facebook"></i></a>
                                <a href="#"><i class="social_googleplus"></i></a>
                                <a href="#"><i class="social_instagram"></i></a>
                                <a href="#"><i class="social_youtube"></i></a>
                            </div>
                            <div class="copyright">
                                <p>Copyright © 2021 HasThemes | <a href="https://hasthemes.com/">Built with <span>Norda</span> by HasThemes</a>.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- All JS is here
============================================ -->

    <script src="assets/js/vendor/modernizr-3.11.7.min.js"></script>
    <script src="assets/js/vendor/jquery-v3.6.0.min.js"></script>
    <script src="assets/js/vendor/jquery-migrate-v3.3.2.min.js"></script>
    <script src="assets/js/vendor/bootstrap.bundle.min.js"></script>
    <script src="assets/js/plugins/slick.js"></script>
    <script src="assets/js/plugins/jquery.syotimer.min.js"></script>
    <script src="assets/js/plugins/jquery.instagramfeed.min.js"></script>
    <script src="assets/js/plugins/jquery.nice-select.min.js"></script>
    <script src="assets/js/plugins/wow.js"></script>
    <script src="assets/js/plugins/jquery-ui-touch-punch.js"></script>
    <script src="assets/js/plugins/jquery-ui.js"></script>
    <script src="assets/js/plugins/magnific-popup.js"></script>
    <script src="assets/js/plugins/sticky-sidebar.js"></script>
    <script src="assets/js/plugins/easyzoom.js"></script>
    <script src="assets/js/plugins/scrollup.js"></script>
    <script src="assets/js/plugins/ajax-mail.js"></script>

    <!-- Use the minified version files listed below for better performance and remove the files listed above  
<script src="assets/js/vendor/vendor.min.js"></script>
<script src="assets/js/plugins/plugins.min.js"></script>  -->
    <!-- Main JS -->
    <script src="assets/js/main.js"></script>

</body>

</html>

    <script>

        /** Form Validation Start **/

        const form = document.getElementById('submit-form');
        const fName = document.getElementById('fname-input');
        const lName = document.getElementById('lname-input');
        const emailId = document.getElementById('email-input');
        const mobNo = document.getElementById('mobno-input');
        const oldPassword = document.getElementById('oldpassword-input');
        const newPassword = document.getElementById('newpassword-input');
        const confirmPassword = document.getElementById('confirmpassword-input');
        // const address = document.getElementById('address-input');



        form.addEventListener('submit', e => {


            e.preventDefault();
            validateInput();
        });

        const setError = (element, message) => {

            const inputControl = element.parentElement;
            // const errorDisplay = inputControl.querySelector('.error');
            // errorDisplay.innerText=message;

            element.placeholder = message;
            fName.style.border = '1.5px solid red';
            lName.style.border = '1.5px solid red';
            emailId.style.border = '1.5px solid red';
            mobNo.style.border = '1.5px solid red';
            // address.style.border = '1.5px solid red';
            inputControl.classList.add('error');
            inputControl.classList.remove('success');

        };

        const setSuccess = element => {

            const inputControl = element.parentElement;
            // const errorDisplay= inputControl.querySelector('.error');
            // errorDisplay.innerText='';
            element.placeholder = '';
            inputControl.classList.add('success');
            inputControl.classList.remove('error');
        };

        const isValidFName = fName => {

            const rename = /^[a-zA-Z]/;
            return rename.test(String(fName));
        };

        const isValidLName = lName => {

            const rename = /^[a-zA-Z]/;
            return rename.test(String(lName));
        };

        const isValidEmail = emailId => {

            const re = /^[a-zA-Z0-9+_.-]+@[a-zA-Z0-9.-]+$/;
            return re.test(String(emailId).toLowerCase());
        };

        const isValidMobNo = mobNo => {

            const re = /^[0-9]{10}$/;
            return re.test(mobNo);
        };

        // const isValidAddress = address => {

        //     const re = /^[A-Za-z]/;
        //     return re.test(address);
        // };

        const validateInput = () => {
            console.log("Entered to validate input");
            const firstNameValue = fName.value.trim();
            const lastNameValue = lName.value.trim();
            const emailIdValue = emailId.value.trim();
            const mobNoValue = mobNo.value.trim();
            // const addressValue = address.value;



            if (firstNameValue === '') {

                setError(fName, 'First Name is required');

            } else if (!isValidFName(firstNameValue)) {
                //setError(username);
                document.getElementById('message-error').innerHTML = 'Names should be alphabets';


            } else {
                console.log("fName Ok");
                setSuccess(fName);
            }

            if (lastNameValue === '') {

                setError(lName, 'Last Name is required');

            } else if (!isValidLName(lastNameValue)) {
                //setError(username);
                document.getElementById('message-error').innerHTML = 'Names should be alphabets';


            } else {
                console.log("lName Ok");
                setSuccess(lName);
            }

            if (emailIdValue === '') {

                setError(emailId, 'Email is required');

            } else if (!isValidEmail(emailIdValue)) {

                //alert('Provide a valid Email address')
                document.getElementById('message-error').innerHTML = 'Provide a valid email address';

            } else {
                console.log("email Ok");
                setSuccess(emailId);
            }

            if (mobNoValue === '') {

                setError(mobNo, 'Mobile No is required');

            } else if (!isValidMobNo(mobNoValue)) {

                //alert('Provide a valid Email address')
                document.getElementById('message-error').innerHTML = 'Provide a valid mobile number';

            } else {
                console.log("Mobile oK")
                setSuccess(mobNo);
            }

            // if (addressValue === '') {

            //     setError(address);
            // } else if (!isValidAddress(addressValue)) {

            //     document.getElementById('message-error').innerHTML = 'Enter a valid address';
            // } else {

            //     setSuccess(address);
            // }

            //FOR SUBMISSION:

            const inputs = [fName, lName, emailId, mobNo];

            if (inputs.every(input => input.parentElement.classList.contains('success'))) {
                form.submit();
                console.log("Edit Profile successful")
            }

        };

        /** Form Validation End **/
    </script>